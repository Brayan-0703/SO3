Comandos usados practica 1

curl -o webmin-setup-repo.sh https://raw.githubusercontent.com/webmin/webmin/master/webmin-setup-repo.sh
sudo sh webmin-setup-repo.sh
sudo apt-get install webmin --install-recommends

firefox localhost:10000

============================================

Comandos usados practica 2

wget https://releases.hashicorp.com/terraform/1.14.0/terraform_1.14.0_linux_amd64.zip
7z x terraform_1.14.0_linux_amd64.zip
sudo mv terraform /usr/local/bin
mkdir terraform

nano main.tf
terraform {
  required_providers {
    digitalocean = {
      source  = "digitalocean/digitalocean"
      version = "~> 2.0"
    }
  }
}

provider "digitalocean" {
  token = "API DIGITALOCEAN"
}

resource "digitalocean_ssh_key" "kali_key" {
  name       = "brayan-kali-key" 
  public_key = "PUBLIC SSH KEY"
}

resource "digitalocean_droplet" "os3_vm" {
  image    = "ubuntu-22-04-x64"
  name     = "OS3vm"
  region   = "nyc1"
  size     = "s-1vcpu-1gb"
  ssh_keys = [
    digitalocean_ssh_key.kali_key.id
  ]
  backups  = false 
}

terraform init
terraform plan
terraform apply

ssh root@147.182.130.121

============================================

Comandos usados practica 3

sudo apt install ansible -y
mkdir -p /etc/ansible
sudo nano /etc/ansible/ansible.cfg
[defaults]
inventory = /etc/ansible/hosts
private_key_file = /home/brayan/.ssh/id_rsa
host_key_checking = False
ask_become_pass = True

[ssh_connection]
ssh_args = -o ForwardAgent=yes -o ControlMaster=auto -o ControlPersist=60s

sudo nano /etc/ansible/hosts
[win]
10.0.0.90
[win:vars]
ansible_user=ansible
ansible_password=1234
ansible_port=5985
ansible_connection=winrm
ansible_winrm_transport=basic
ansible_winrm_server_cert_validation=ignore
[linux]
67.205.139.146
[linux:vars]
ansible_user=ansible
ansible_ssh_private_key_file= ~/.ssh/id_rsa
ansible_become_password=1234
[all:vars]
ansible_python_interpreter=/usr/bin/python3

ssh-keygen -t rsa -b 4096
cat .ssh/id_rsa.pub


sudo useradd -m -s /bin/bash ansible
sudo usermod -aG sudo ansible
sudo mkdir -p /home/ansible/.ssh
sudo touch /home/ansible/.ssh/authorized_keys
sudo chmod 600 /home/ansible/.ssh/authorized_keys
sudo chown ansible:ansible /home/ansible/.ssh/authorized_keys
sudo nano /home/ansible/.ssh/authorized_keys


ssh ansible@67.205.139.146

 + R --> wf.msc
Reglas de entrada
Administracién remota de registro de eventos (NP de entrada) - Habilitar regla
Administracién remota de registro de eventos (NP de entrada) - Habilitar regla
-
Administracién remota de registro de eventos (RPC) - Habilitar regla

Configuracion > Internet y red > Estado > Propiedades > Público --> Privada

PowerShell as Admin

Set-ExecutionPolicy Remotesigned -Force
Enable-PSRemoting -Force
Set-Item WSMan:\localhost\Service\AllowUnencrypted -Value $true
Set-Item WSMan:\localhost\Service\Auth\Basic -Value $true
Set-Item WSMan:\localhost\Client\TrustedHosts -Value '*' -Force
netsh advfirewall firewall add rule name="WinRM HTTP" dir=in action=allow protocol=TCP localport=5985
netsh advfirewall firewall set rule group="Administración remota de Windows" new enable=yes
Restart-Service WinRM
$Password = ConvertTo-SecureString "1234" -AsPlainText -Force
New-LocalUser -Name "ansible" -Password $Password -FullName "Ansible User" -Description "Usuario Ansible"
Add-LocalGroupMember -Group “Administradores" -Member "ansible"
winrm enumerate winrm/config/listener
Test-NetConnection -ComputerName localhost -Port 5985


ansible linux -m ping -u ansible
ansible win -m win_ping

============================================

Comandos usados practica 4

ansible win -m win_copy -a "src='C:/Users/brayan/Desktop/prueba.txt' dest='C:/Users/brayan/Documents/' remote_src=yes"


passwd ansible
1234
1234


ansible linux -m reboot -b -K

============================================

Comandos usados practica 5

nano install_notepad.yml
---
- name: Instalar Notepad++ en Windows
  hosts: win
  tasks:
    - name: Asegurar que Chocolatey este instalado
      win_shell: |
        Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
      args:
        creates: C:\ProgramData\chocolatey\bin\choco.exe

    - name: Instalar Notepad++
      win_chocolatey:
        name: notepadplusplus
        state: present

ansible-playbook install_notepad.yml

nano install_nginx.yml
---
- name: Instalar y Configurar Nginx
  hosts: linux
  become: yes
  tasks:
    - name: Instalar Nginx
      apt:
        name: nginx
        state: present
        update_cache: yes

    - name: Iniciar y habilitar servicio Nginx
      service:
        name: nginx
        state: started
        enabled: yes

ansible-playbook install_nginx.yml

============================================
